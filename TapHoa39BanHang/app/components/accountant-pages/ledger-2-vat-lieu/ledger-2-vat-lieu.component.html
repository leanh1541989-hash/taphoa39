<!--
  S2-HKD: SỔ CHI TIẾT VẬT LIỆU, DỤNG CỤ, SẢN PHẨM, HÀNG HÓA
  Circular 88/2021/TT-BTC - Appendix 2 - Mẫu số S2-HKD
-->
<div class="ledger-page">
  <!-- Page Title -->
  <h2 class="page-title">SỔ CHI TIẾT VẬT LIỆU, DỤNG CỤ, SẢN PHẨM, HÀNG HÓA</h2>

  <!-- Material Info -->
  <div class="material-info">
    <div class="info-row">
      <label>Tên vật liệu (sản phẩm, hàng hóa):</label>
      <input type="text" [(ngModel)]="tenVatLieu" (blur)="saveData()" placeholder="VD: Gạo, Đường, Muối..." />
    </div>
    <div class="info-row">
      <label>Đơn vị tính:</label>
      <input type="text" [(ngModel)]="donViTinh" (blur)="saveData()" placeholder="VD: Kg, Gói, Thùng..." />
    </div>
  </div>

  <!-- Opening Balance -->
  <div class="opening-balance">
    <div class="balance-title">Số dư đầu kỳ</div>
    <div class="balance-grid">
      <div class="balance-item">
        <label>Số lượng:</label>
        <input type="number" [(ngModel)]="soDuDauKy.soLuong" (blur)="updateSoDuDauKy()" />
      </div>
      <div class="balance-item">
        <label>Thành tiền:</label>
        <input type="number" [(ngModel)]="soDuDauKy.thanhTien" (blur)="updateSoDuDauKy()" />
      </div>
    </div>
  </div>

  <!-- Entry Form -->
  <div class="entry-form">
    <div class="form-title">Thêm bút toán mới</div>
    <div class="form-grid">
      <div class="form-group">
        <label>Số hiệu CT *</label>
        <input type="text" [(ngModel)]="newRecord.chungTu!.soHieu" placeholder="VD: PN001" />
      </div>
      <div class="form-group">
        <label>Ngày CT</label>
        <input type="date" [(ngModel)]="newRecord.chungTu!.ngayThang" />
      </div>
      <div class="form-group form-group-wide">
        <label>Diễn giải *</label>
        <input type="text" [(ngModel)]="newRecord.dienGiai" placeholder="Nội dung nhập/xuất" />
      </div>
      <div class="form-group">
        <label>Đơn vị tính</label>
        <input type="text" [(ngModel)]="newRecord.donViTinh" [placeholder]="donViTinh" />
      </div>
      <div class="form-group">
        <label>Đơn giá</label>
        <input type="number" [(ngModel)]="newRecord.donGia" placeholder="0" />
      </div>
      <div class="form-group">
        <label>Nhập - SL</label>
        <input type="number" [(ngModel)]="newRecord.nhapSoLuong" placeholder="0" />
      </div>
      <div class="form-group">
        <label>Nhập - Tiền</label>
        <input type="number" [(ngModel)]="newRecord.nhapThanhTien" placeholder="Tự tính" />
      </div>
      <div class="form-group">
        <label>Xuất - SL</label>
        <input type="number" [(ngModel)]="newRecord.xuatSoLuong" placeholder="0" />
      </div>
      <div class="form-group">
        <label>Xuất - Tiền</label>
        <input type="number" [(ngModel)]="newRecord.xuatThanhTien" placeholder="Tự tính" />
      </div>
      <div class="form-group">
        <label>Ghi chú</label>
        <input type="text" [(ngModel)]="newRecord.ghiChu" />
      </div>
      <div class="form-group">
        <button class="btn-add" (click)="addRecord()">+ Thêm</button>
      </div>
    </div>
  </div>

  <!-- Summary -->
  <div class="summary-bar">
    <span>Tổng số bút toán: <strong>{{ data.length }}</strong></span>
    <span>Tổng nhập: <strong>{{ getTongNhap() }}</strong></span>
    <span>Tổng xuất: <strong>{{ getTongXuat() }}</strong></span>
  </div>

  <!-- Data Table -->
  <app-ledger-table
    [headerRows]="headerRows"
    [columnLabels]="columnLabels"
    [dataColumns]="dataColumns"
    [data]="data"
    [footerRows]="footerRows"
    [showStt]="false"
    [editable]="true"
    (rowSaved)="updateRecord($event)"
    (rowDeleted)="deleteRecord($event)">
  </app-ledger-table>
</div>
