<div class="container">
  <!-- Header -->
  <div class="header-section">
    <h1>Sổ Chi Tiết Doanh Thu</h1>
    <p>Bán lẻ tạp hóa – Hóa đơn máy tính tiền</p>
  </div>

  <!-- Month Filter -->
  <div class="filter-section">
    <label class="filter-label">Lọc theo tháng:</label>
    <div class="filter-controls">
      <select
        [(ngModel)]="selectedMonth"
        (change)="filterByMonth()"
        class="filter-select"
      >
        <option value="">-- Tất cả tháng --</option>
        <option *ngFor="let m of getAvailableMonths()" [value]="m">
          {{ m }}
        </option>
      </select>
      <button (click)="resetFilter()" class="filter-button">
        Xóa Bộ Lọc
      </button>
    </div>
  </div>

  <!-- Add New Record Form -->
  <div class="form-section">
    <h2>Thêm Doanh Thu</h2>
    <form (ngSubmit)="addRecord()" class="form-grid">
      <div class="form-group">
        <label>Ngày Bán *</label>
        <input
          type="date"
          [(ngModel)]="newRecord.ngayBan"
          name="ngayBan"
          required
        />
      </div>

      <div class="form-group">
        <label>Số Hóa Đơn *</label>
        <input
          type="text"
          [(ngModel)]="newRecord.soHoaDon"
          name="soHoaDon"
          placeholder="e.g., HD001"
          required
        />
      </div>

      <div class="form-group">
        <label>Hình Thức Bán *</label>
        <select
          [(ngModel)]="newRecord.hinhThucBan"
          name="hinhThucBan"
          required
        >
          <option value="TM">Tiền Mặt</option>
          <option value="CK">Chuyển Khoản</option>
        </select>
      </div>

      <div class="form-group">
        <label>Nhóm Hàng *</label>
        <select
          [(ngModel)]="newRecord.nhomHang"
          name="nhomHang"
          required
        >
          <option value="NuocNgot">Nước Ngọt</option>
          <option value="BanhKeo">Bánh Kẹo</option>
          <option value="NhuYeuPham">Nhu Yếu Phẩm</option>
          <option value="Khac">Khác</option>
        </select>
      </div>

      <div class="form-group">
        <label>Doanh Thu Chưa VAT *</label>
        <input
          type="number"
          [(ngModel)]="newRecord.doanhThuChuaVAT"
          name="doanhThuChuaVAT"
          placeholder="0"
          required
        />
      </div>

      <div class="form-group">
        <label>Thuế VAT</label>
        <input
          type="number"
          [(ngModel)]="newRecord.thueVAT"
          name="thueVAT"
          placeholder="0"
        />
      </div>

      <div class="form-group">
        <label>Ghi Chú</label>
        <input
          type="text"
          [(ngModel)]="newRecord.ghiChu"
          name="ghiChu"
        />
      </div>

      <div class="form-group">
        <button type="submit" class="form-submit">
          Thêm Doanh Thu
        </button>
      </div>
    </form>
  </div>

  <!-- Summary Stats -->
  <div class="summary-stats">
    <div class="stat-card blue">
      <p class="stat-label">Tổng Số Hóa Đơn</p>
      <p class="stat-value">{{ filteredData.length }}</p>
    </div>
    <div class="stat-card green">
      <p class="stat-label">Tổng Doanh Thu</p>
      <p class="stat-value">{{ sumDoanhThu() }}</p>
    </div>
    <div class="stat-card purple">
      <p class="stat-label">Tổng Thanh Toán</p>
      <p class="stat-value">{{ sumThanhToan() }}</p>
    </div>
  </div>

  <!-- Data Table -->
  <div class="table-container">
    <app-ledger-table
      [data]="filteredData"
      [columns]="tableColumns"
      (rowSaved)="updateRecord($event)"
      (rowDeleted)="deleteRecord($event)"
    ></app-ledger-table>
  </div>
</div>
